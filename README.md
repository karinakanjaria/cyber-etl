# cyber-etl
DSE 203 Project- Cybersecurity data merging from multiple sources to create and query a knowledge graph for insights.

## Files:
0. `dse203_project_environment.yml` - Conda environment export. Use with `conda env create -f dse203_project_environment.yml`
1. `parse_cve_json_data.py` - Script to convert NIST CVE JSON data into a format ready to import into Neo4j
2. `mitre_json_to_csv.py` - MITRE provided script to pull MITRE JSON data into CSV for Techniques/Tactics Nodes

### Data Folder Files (./data)
3. `cve_node_data.feather` - Data for creating CVE nodes
4. `cve_references.feather` - Data for creating tag nodes and linking the tagged references to CVE nodes
5. `nvdcve-1.1-20*.json.gz` - Raw JSON CVE data from NIST
6. `cpe_node_data.feather` - Data for creating nodes for Configs, Platforms, etc related to CVEs
7. `enterprise-attack.csv` - Data generated by the 'mitre_json_to_csv.py' script to create nodes for TTPs
8. `alert_nodes.csv` - Data for creating alerts nodes and linking CVEs referenced in the alerts
9. `ner_node.csv` - Data for creating Named Entities mentioned in the alerts
10. `ner_training.json` - Manually labeled matching entitites
11. `countries_of_the_world.csv` - Data for matching NER entitites to related country information
12. `stopwords.txt` - List of stopwords from Kaggle dataset (https://www.kaggle.com/datasets/rowhitswami/stopwords?resource=download)


## Loading data into neo4j:
Run the following in the neo4j database-

`	CALL apoc.periodic.iterate(
	"CALL apoc.load.json('file:///nvdcve-1.1-2022.json') YIELD value",
	"UNWIND value.CVE_Items AS data  \r\n"+
	"UNWIND data.cve.references.reference_data AS references \r\n"+
	"UNWIND data.publishedDate AS publishedDate \r\n"+
	"UNWIND data.cve.description.description_data AS description_data \r\n"+
	"UNWIND data.impact.baseMetricV3.exploitabilityScore AS exploitabilityScore \r\n"+
	"UNWIND data.impact.baseMetricV3.impactScore AS impactScore \r\n"+
	"UNWIND data.impact.baseMetricV3.cvssV3.baseScore AS baseScore \r\n"+
	"MERGE (cveItem:CVE {uid: apoc.create.uuid()}) \r\n"+
	"ON CREATE SET cveItem.cveid = data.cve.CVE_data_meta.ID, cveItem.publishedDate = publishedDate, cveItem.description = description_data.value, cveItem.exploitabilityScore = exploitabilityScore, cveItem.impactScore = impactScore, cveItem.baseScore = baseScore, cveItem.referenceURL = references.url, cveItem.referenceName = references.name, cveItem.referenceSource = references.refsource, cveItem.referenceTags = references.tags",
	 {batchSize:100, iterateList:true});`

This will create nodes with IDs, publishedDates, Descriptions, Scores, and References
